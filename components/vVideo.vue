<template>
	<view class="box">
		<view class="head clearfix">
			<view class="left">
				<image src="/static/a.png" mode=""></image>
				<view class="rukou">人员考勤通道</view>
			</view>
			<view class="right clearfix">
				<view class="item _item">
					<view class="title">{{date}}</view>
					<view style="color: #03c7e5" class="text">更新时间</view>
				</view>
				<view v-for="(item, index) in DayData" :key="index" class="item">
					<view class="title">{{ item.itemavgvalue }}</view>
					<view :style="{ color: item.color }" class="text">{{ item.itemname }}</view>
				</view>
				<image src="/static/qqq.png" mode=""></image>
			</view>
		</view>
		<view class="common clearfix" v-if="show" >
			<video :src="url" class="video" autoplay :controls="false"></video>
		</view>
		<view class="foot">
			<view class="title">班组进场统计</view>
			<view class="group">
				<view class="group-item" v-for="(item,index) in group" :key="index">
					<text style="color: #2ef8ff;padding-right: 4rpx;">{{item.groupName}}</text>
					<text style="color: #ffe92b;padding-right: 10rpx;">{{item.curNum + '/'  + item.totalNum + ' '}}</text>
				</view>
			</view>
		</view>
	</view>
</template>

<script>
export default {
	data() {
		return {
			Interval:null,
			group:[],
			date:'',
			DayData: [, , , , , ,],
			show:false,
			url: 'http://hls01open.ys7.com/openlive/53aed9bf0fd04dd88ac1fccf04ed2478.hd.m3u8'
		};
	},
	created() {
		this.getinit()
		this.getInterval2()
		this.Interval = setInterval(() => {
			this.getinit()
		}, 1000 * 30);
	},
	deactivated() {
		clearInterval(this.Interval);
		clearInterval(this.Interval2);
	},
	methods: {
		getinit(){
			this.getToDayData()
			this.getGroup()
			this.getDate()
		},
		getInterval2(){
			this.show = true
			this.Interval2 = setInterval(() => {
				this.show = false
				setTimeout(()=>{
					this.show = true
				},20)
			}, 1000 * 60 * 5);
		},
		getDate(){
			const date = new Date();
			const h = date.getHours() < 10 ? '0' + date.getHours() : date.getHours();
			const m = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();
			const s = date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds();
			this.date = h + ':' + m + ':' + s
		},
		getToDayData() {
			uni.request({
				url: 'http://113.140.66.229:11016/visualzation/getToDayData',
				method: 'post',
				success: res => {
					const color = ['#03c7e5', '#b946f0', '#4291fd', '#82ff45', ' #ff45a1', '#3ceb5c'];
					const daydate = res.data.data.map((val, index) => {
						val.itemavgvalue = val.itemavgvalue.toPrecision(3)
						val.color = color[index]
						return val
					});
					this.DayData = daydate;
				}
			});
		},
		getGroup() {
			uni.request({
				url: 'http://113.140.66.229:11016/visualzation/getGroup',
				method: 'post',
				success: res => {
					if(res.data.data.length == 0){
						this.getGroup()
					}else{
						this.group = res.data.data
					}
				}
			});
		}
	}
};
</script>

<style scoped lang="scss">
.clearfix:after {
	content: '';
	display: block;
	height: 0;
	clear: both;
	visibility: hidden;
}

.box {
	width: 414rpx;
	height: 320rpx;
	background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABCQAAAMfCAYAAAAOjAbpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwOC8wNC8yMJBmXNIAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAUmklEQVR4nO3cMUoDQRiAURXBA6Sy8w6xELxHzmCXw+UEgm1qIX0gAZtsmoCNtTZJs1/UvFdP8bMzy8DHstd3988fVwAAAACh23MPAPDXPL68TY6tWS3mw7Befhbz/HcPT7Ojz3tsm/fX4bDbftvP6QnngMuyWsyH/Y/3/reeX8bjjgA43c25BwAAAAAujyABAAAA5AQJAAAAIHftp5YAAABAzRcSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkBAkAAAAgJ0gAAAAAOUECAAAAyAkSAAAAQE6QAAAAAHKCBAAAAJATJAAAAICcIAEAAADkbs89AMA5Pb68TY6tWS3mw7Befhbz/HcPT7Ojz3tsm/fX4bDbftvP6QnngMuyWsyH/Y/3/reeX8bjjgAYly8kAAAAgJwgAQAAAOQECQAAACD3BcKAWM9s7plqAAAAAElFTkSuQmCC')
		no-repeat;
	background-size: 414rpx 320rpx;
	border: solid 0rpx #1b3965;
	opacity: 0.93;
	float: left;
	.head {
		height: 36rpx;
		padding: 0 16rpx;
		.left {
			padding-top: 10rpx;
			float: left;
			.rukou {
				float: left;
				margin-left: 10rpx;
				line-height: 16rpx;
				font-size: 10rpx;
				color: #fff;
			}
			image {
				float: left;
				width: 16rpx;
				height: 16rpx;
			}
		}
		.right {
			float: right;
			color: #fff;
			padding-top: 4rpx;
			.item {
				width: 30rpx;
				float: left;
				text-align: center;
				.title {
					font-size: 12rpx;
				}
				.text {
					font-size: 6rpx;
				}
			}
			._item{
				width: 60rpx;
			}

			image {
				float: right;
				padding-top: 4rpx;
				padding-left: 6rpx;
				width: 16rpx;
				height: 16rpx;
			}
		}
	}
	.common {
		width: 400rpx;
		height: 224rpx;
		margin: 0 auto;
		.video {
			width: 400rpx;
			height: 224rpx;
		}
	}
	.foot{
		height: 60rpx;
		padding: 10rpx;
		.title{
			font-size: 8rpx;
			line-height: 40rpx;
			color: #9aadca;
			float: left;
			margin-right: 20rpx;
		}
		.group{
			font-size: 8rpx;
			.group-item{
				float: left;
				line-height: 20rpx;
			}
		}
	}
}
</style>
